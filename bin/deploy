#
# READ THIS WHOLE PROCEDURE
#
echo "STOP!!! Read this script before running. Make sure you have what you need."
read "[Press Enter to Continue]"

# missing assurance that docker passes tests
ACCOUNT=tgrayson
ENV_VARS="-e HOST=https://raw.githubusercontent.com"

declare -A hostports
hostports[pointillism]=5001
hostports[cribnot.es]=5000

#
# HUMAN: 1. confirm env vars are installed
#
echo "+============================================+"
echo "| fetching latest image for: $ACCOUNT |"
echo "+============================================+"
docker pull $ACCOUNT/$1:latest

# HUMAN: look for Status: Downloaded newer image for tgrayson/pointillism:latest
echo "If 'Status: Downloaded newer image', then continue. Do you have your docker run statement ready?"
echo "docker run -d -p ${hostports[$1]}:${hostports[$1]} --name $1 -e HOST=https://raw.githubusercontent.com $ACCOUNT/$1"
echo "This will delete the running instance, so be sure you're ready to stand it up again. [Press Enter]"
read "continue"
docker stop $1
docker images prune
docker rm $1
docker rmi $ACCOUNT/$1
docker rmi $1

# echo "This next line isn't including any additional app specific arguments." 
# echo "You may want to copy paste the next line to make it right."
# read "continue"

# not everybody needs the HOST, but it doesn't hurt anything
# docker run -d -p ${hostports[$1]}:${hostports[$1]} --name $1 -e HOST=https://raw.githubusercontent.com $ACCOUNT/$1


#                      COMMAND              CREATED             STATUS              PORTS                    NAMES
# pointillism:latest   "python server.py"   31 minutes ago      Up 31 minutes       0.0.0.0:5001->5001/tcp   pointillism
# cribnot.es:latest    "python server.py"   About an hour ago   Up About an hour    0.0.0.0:5000->5000/tcp   cribnot.es
